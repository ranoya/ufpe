<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="pinterest" content="nopin" />
    <meta name="pinterest" content="nohover" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1"
    />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="keywords" content="" />
    <title>Documentos</title>
    <meta property="og:title" content="Documentos" />
    <meta name="generator" content="Google Forms" />
    <meta name="description" content="Documentos dos Estudantes" />
    <meta property="og:description" content="Documentos dos Estudantes" />
    <meta name="author" content="Guilherme Ranoya" />
    <meta property="og:url" content="https://ufpe.vercel.app/alunosdocs" />
    <meta property="og:type" content="interface" />
    <meta property="og:locale" content="pt_BR" />
    <meta property="og:site_name" content="Documentos dos Estudantes" />
    <meta name="application-name" content="Documentos dos Estudantes" />

    <script src="https://datat.vercel.app/basicsmin.js"></script>

    <style>
      * {
        border: 0;
        padding: 0;
        margin: 0;
      }

      body,
      html {
        margin: 40px 40px 40px 40px;
        background-color: white;
        color: gray;
        font-family: Arial, sans-serif;
        font-size: 16px;
      }

      a {
        color: rgb(82, 127, 226);
      }

      #lista {
        display: grid;
        grid-template-columns: 1fr 160px 60px 60px 1fr 80px 60px 1fr 1fr 50px 50px 50px 50px;
        gap: 10px 20px;
      }

      input {
        padding-left: 20px;
        padding-right: 20px;
        outline: 0;
        width: 300px;
        height: 30px;
        font-size: 16px;
        margin-bottom: 50px;
      }

      input:focus {
        outline: 0;
        border-bottom: 1px dashed #d1d1d1;
      }

      .head {
        font-size: 12px;
        text-transform: uppercase;
        color: #d1d1d1;
      }

      .linha {
        grid-column: 1 / span 13;
        background-color: #d1d1d1;
        height: 1px;
        margin-top: 5px;
        margin-bottom: 5px;
      }

      .icone {
        width: 20px;
        height: 20px;
      }

      .icone path {
        fill: grey;
      }

      .icone:hover path {
        fill: rgb(82, 127, 226);
      }
    </style>
  </head>

  <body>
    <input type="text" id="filtra" placeholder="Filtrar..." />

    <div id="lista"></div>

    <script>
      omnifilter = function (arr) {
        let alunos = unique(arr, "Aluno");
        let code = `<div class="head">ALUNO</div><div class="head">AF</div><div class="head">TRANC.</div><div class="head">PRORR.</div><div class="head">BOLSAS</div><div class="head">N√çVEL</div><div class="head">ENTRADA</div><div class="head">ORIENTADOR</div><div class="head">EMAIL</div><div class="head">ECON.</div><div class="head">PSIQ.</div><div class="head">PcD</div><div class="head">CUIDAD.</div>
        
        <div class="linha"></div>`;

        for (let i = 0; i < alunos.length; i++) {
          if (alunos[i] != "#N/A") {
            for (let a = 0; a < arr.length; a++) {
              if (alunos[i] == arr[a].Aluno) {
                code += `<div>${alunos[i]}</div><div>${arr[a].Acoes}</div><div>${arr[a].Trancamentos}</div><div>${arr[a].Prorrogacoes}</div><div>${arr[a].Bolsas}</div><div>${arr[a].Nivel}</div><div>${arr[a].Entrada}</div><div>${arr[a].Orientador}</div><div>${arr[a].Email}</div>`;

                if (
                  typeof arr[a].Economica != "undefined" &&
                  arr[a].Economica != "" &&
                  (arr[a].Economica != "undefined") != null
                ) {
                  code += `<div><a target="_blank" href="${arr[a].Economica}"><svg class="icone" viewBox="0 0 20 28" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M20 6.77419L12.3077 0H0V28H20V6.77419Z"/></svg></a></div>`;
                } else {
                  code += `<div></div>`;
                }

                if (
                  typeof arr[a].Emocional != "undefined" &&
                  arr[a].Emocional != "" &&
                  (arr[a].Emocional != "undefined") != null
                ) {
                  code += `<div><a target="_blank" href="${arr[a].Emocional}"><svg class="icone" viewBox="0 0 20 28" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M20 6.77419L12.3077 0H0V28H20V6.77419Z"/></svg></a></div>`;
                } else {
                  code += `<div></div>`;
                }

                if (
                  typeof arr[a].Pcd != "undefined" &&
                  arr[a].Pcd != "" &&
                  (arr[a].Pcd != "undefined") != null
                ) {
                  code += `<div><a target="_blank" href="${arr[a].Pcd}"><svg class="icone" viewBox="0 0 20 28" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M20 6.77419L12.3077 0H0V28H20V6.77419Z"/></svg></a></div>`;
                } else {
                  code += `<div></div>`;
                }

                if (
                  typeof arr[a].Cuidadores != "undefined" &&
                  arr[a].Cuidadores != "" &&
                  (arr[a].Cuidadores != "undefined") != null
                ) {
                  code += `<div><a target="_blank" href="${arr[a].Cuidadores}"><svg class="icone" viewBox="0 0 20 28" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M20 6.77419L12.3077 0H0V28H20V6.77419Z"/></svg></a></div>`;
                } else {
                  code += `<div></div>`;
                }

                code += `                
                <div class="linha"></div>`;

                break;
              }
            }
          }
        }

        document.getElementById("lista").innerHTML = code;
        console.table(alunos);
      };

      omnifilterfetchcsvdata(
        GoogleSheetCsvURL(
          "https://docs.google.com/spreadsheets/d/1z-tTRAQ0sr3s2antFnizwY83H1L8esjCgLeGEFak73g/edit?resourcekey=&gid=279175707#gid=279175707"
        ),
        "filtra"
      );
    </script>
  </body>
</html>
